function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,s=function e(){};return{s:s,n:function t(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function e(t){throw t},f:s}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,r=!1;return{s:function t(){i=i.call(e)},n:function e(){var t=i.next();return a=t.done,t},e:function e(t){r=!0,o=t},f:function e(){try{a||null==i.return||i.return()}finally{if(r)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _arrayLikeToArray(e,t)}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==_typeof(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){return t.__proto__=i,t})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function i(){var n,s=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(s,arguments,o)}else n=s.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var game,snake,food,bonus,UP=0,DOWN=1,LEFT=2,RIGHT=3,CELL=32,game_version="v 0.1.3",game_session={ts:0,game_id:"",action:{startGameSession:0,startGame:0,levelUp:0,gameOver:0,closeGameSession:0},score:null,highscore:null,level:null,onClose:!1};function getTexturePack(){return Math.floor(3*Math.random())}var gameState={onMenu:!1,onPause:!1,isOver:!1,onGame:!1,score:0};window.onload=function(){var e={type:Phaser.CANVAS,width:1920,height:1080,backgroundColor:"#000",parent:"phaser-example",scene:[preloader,mainMenu,snacegame,scenePause,gameOver],physics:{default:"arcade"},scale:{mode:Phaser.Scale.FIT},audio:{noAudio:!0}};document.getElementsByTagName("canvas").outline=0,game=new Phaser.Game(e)};var Entity=function(e){"use strict";_inherits(i,e);var t=_createSuper(i);function i(e,n,s,o){var a;return _classCallCheck(this,i),(a=t.call(this,e,n,s)).scene=e,a.scene.add.existing(_assertThisInitialized(a)),a.setData("type",o),a.setData("isDead",!1),a}return _createClass(i)}(Phaser.GameObjects.Image),Food=function(e){"use strict";_inherits(i,e);var t=_createSuper(i);function i(e,n,s){var o;return _classCallCheck(this,i),(o=t.call(this,e,n,s)).body=o.scene.physics.add.sprite(n*CELL,s*CELL,"food").play("food-animation"),o.body.setDisplaySize(32,32),o.body.setSize(30,30,!0),o.body.setOrigin(.5),o.total=0,o}return _createClass(i,[{key:"eat",value:function e(){this.total++}}]),i}(Entity),Bonus=function(e){"use strict";_inherits(i,e);var t=_createSuper(i);function i(e,n,s,o,a){var r;return _classCallCheck(this,i),(r=t.call(this,e,n,s)).onPlate=!1,r.body=r.scene.physics.add.sprite(n*CELL,s*CELL,o).play("bonus-animation_".concat(a)),r.body.setDisplaySize(32,32),r.body.setOrigin(.5),r.index=a,r.bonusSound=r.scene.sound.add("bonus",{loop:!1,volume:.5}),r.scene.anims.create({key:"bonus-animation_0",frames:[{key:"bonus_small_".concat(0),duration:500},{key:"bonus_".concat(0),duration:500},{key:"bonus_big_".concat(0),duration:500}],frameRate:6,repeat:-1}),r.scene.anims.create({key:"bonus-animation_1",frames:[{key:"bonus_small_".concat(1),duration:500},{key:"bonus_".concat(1),duration:500},{key:"bonus_big_".concat(1),duration:500}],frameRate:6,repeat:-1}),r}return _createClass(i)}(Entity),Snake=function(e){"use strict";_inherits(i,e);var t=_createSuper(i);function i(e,n,s){_classCallCheck(this,i),(o=t.call(this,e,n,s)).headPosition=new Phaser.Geom.Point(n,s),o.body=e.add.group(),o.head=o.scene.physics.add.sprite(n*CELL,s*CELL,"head_".concat(mainMenu.texturePack)).play("liking_".concat(mainMenu.texturePack)),o.body.add(o.head),o.head.setOrigin(.5),o.head.setScale(.55),o.head.setDepth(4),o.head.rotation=4.7,o.alive=!0,o.speed=130,o.moveTime=0,o.tail=o.scene.physics.add.sprite(o.head.x,o.head.y,"tail_".concat(mainMenu.texturePack)),o.body.add(o.tail),o.tail.setOrigin(.5),o.tail.setDisplaySize(32,32),o.tail.setSize(32,32,!0),o.end=new Phaser.Geom.Point(n,s),o.heading=RIGHT,o.direction=RIGHT,o.bodySegments=o.body.getChildren(),o.onGod=!1,o.biteSound=o.scene.sound.add("bite",{loop:!1,volume:.5}),o.leftSound=o.scene.sound.add("left",{loop:!1,volume:.5}),o.rightSound=o.scene.sound.add("right",{loop:!1,volume:.5}),o.upSound=o.scene.sound.add("up",{loop:!1,volume:.5}),o.downSound=o.scene.sound.add("down",{loop:!1,volume:.5}),o.deadSound=o.scene.sound.add("lose",{loop:!1,volume:.5}),o.turnPoints=[];var o,a=new Phaser.Geom.Point(o.head.x,o.head.y);a.name="turnPointL";var r=new Phaser.Geom.Point(o.head.x,o.head.y);r.name="turnPointR";var h=new Phaser.Geom.Point(o.head.x,o.head.y);h.name="turnPointU";var c=new Phaser.Geom.Point(o.head.x,o.head.y);return c.name="turnPointD",o.turnPoints.push(a,r,h,c),o}return _createClass(i,[{key:"snakeRotation",value:function e(){this.bodySegments=this.body.getChildren();for(var t=1;t<this.bodySegments.length;t++)for(var i=0;i<this.turnPoints.length;i++)this.bodySegments[t].x==this.turnPoints[i].x&&this.bodySegments[t].y==this.turnPoints[i].y&&(this.bodySegments[t].rotation=this.bodySegments[t-1].rotation)}},{key:"update",value:function e(t){if(!0==gameState.onGame&&(this.snakeRotation(),t>=this.moveTime))return this.move(t)}},{key:"faceLeft",value:function e(){if(!0==gameState.onGame&&(this.direction===UP||this.direction===DOWN)){this.heading=LEFT,this.leftSound.play(),this.head.rotation=1.57;var t=new Phaser.Geom.Point(this.head.x,this.head.y);this.turnPoints.push(t)}}},{key:"faceRight",value:function e(){if(!0==gameState.onGame&&(this.direction===UP||this.direction===DOWN)){this.heading=RIGHT,this.rightSound.play(),this.head.rotation=4.71;var t=new Phaser.Geom.Point(this.head.x,this.head.y);this.turnPoints.push(t)}}},{key:"faceUp",value:function e(){if(!0==gameState.onGame&&(this.direction===LEFT||this.direction===RIGHT)){this.heading=UP,this.upSound.play(),this.head.rotation=3.15;var t=new Phaser.Geom.Point(this.head.x,this.head.y);this.turnPoints.push(t)}}},{key:"faceDown",value:function e(){if(!0==gameState.onGame&&(this.direction===LEFT||this.direction===RIGHT)){this.heading=DOWN,this.downSound.play(),this.head.rotation=0;var t=new Phaser.Geom.Point(this.head.x,this.head.y);this.turnPoints.push(t)}}},{key:"move",value:function e(t){if(!0==gameState.onGame){if(!1===this.onGod)switch(this.heading){case LEFT:this.headPosition.x=Phaser.Math.Clamp(this.headPosition.x-1,3,game.config.width/CELL-3);break;case RIGHT:this.headPosition.x=Phaser.Math.Clamp(this.headPosition.x+1,3,game.config.width/CELL-3);break;case UP:this.headPosition.y=Phaser.Math.Clamp(this.headPosition.y-1,6,game.config.height/CELL-2);break;case DOWN:this.headPosition.y=Phaser.Math.Clamp(this.headPosition.y+1,6,game.config.height/CELL-2)}else if(!0==this.onGod)switch(this.heading){case LEFT:this.headPosition.x=Phaser.Math.Wrap(this.headPosition.x-1,3,game.config.width/CELL-2);break;case RIGHT:this.headPosition.x=Phaser.Math.Wrap(this.headPosition.x+1,2,game.config.width/CELL-3);break;case UP:this.headPosition.y=Phaser.Math.Wrap(this.headPosition.y-1,6,game.config.height/CELL-2);break;case DOWN:this.headPosition.y=Phaser.Math.Wrap(this.headPosition.y+1,6,game.config.height/CELL-2)}return(this.direction=this.heading,Phaser.Actions.ShiftPosition(this.body.children.entries,this.headPosition.x*CELL,this.headPosition.y*CELL,1,this.end),Phaser.Actions.GetFirst(this.bodySegments,{x:this.head.x,y:this.head.y},1)&&!1==this.onGod)?(console.log("dead"),this.alive=!1,this.deadSound.play(),!1):(this.moveTime=t+this.speed,this.head.x=this.head.x,this.alive=!0,!0)}}},{key:"grow",value:function e(){this.tail.setTexture("body_".concat(mainMenu.texturePack)),this.tail.setDisplaySize(40,40),this.tail=this.scene.add.sprite(this.head.x,this.head.y,"tail_".concat(mainMenu.texturePack)),this.tail.rotation=this.bodySegments[this.bodySegments.length-1].rotation,this.body.add(this.tail),this.tail.setOrigin(.5),this.tail.setDisplaySize(40,40)}},{key:"godMode",value:function e(){var t=this;this.onGod=!0,this.head.stop("liking_".concat(mainMenu.texturePack)),this.head.play("onGodeAnimation_".concat(mainMenu.texturePack)),setTimeout(function(){t.onGod=!1,t.head.play("liking_".concat(mainMenu.texturePack))},15e3)}},{key:"speedUp",value:function e(){var t=this;this.speed-=50,setTimeout(function(){t.speed+=50},15e3)}},{key:"collideWithBonus",value:function e(t){return void 0!=this.scene.bonus.body&&this.head.x===t.body.x&&this.head.y===t.body.y&&(1!==t.index?this.speedUp():this.godMode(),t.bonusSound.play(),!0)}},{key:"collideWithFood",value:function e(t){return this.head.x===t.body.x&&this.head.y===t.body.y&&(this.grow(),t.eat(),this.biteSound.play(),this.speed<150&&t.total%5==0&&(this.speed+=5),!0)}},{key:"updateGrid",value:function e(t){var i,n=_createForOfIteratorHelper(this.body.getChildren());try{for(n.s();!(i=n.n()).done;){var s=i.value,o=s.y/CELL;t[s.x/CELL][o]=!1}}catch(a){n.e(a)}finally{n.f()}return t}}]),i}(Entity),SnakeGame=function(e){"use strict";_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.call(this,{key:"snakegame"})}return _createClass(i,[{key:"create",value:function e(){var t=this;game_session.action.startGame=new Date().getTime(),console.log(game_session.action.startGame),gameState.onGame=!0,this.texturePack=mainMenu.texturePack,this.backGround=this.add.image(game.config.width/2,game.config.height/2,"background_".concat(this.texturePack)).setOrigin(.5),this.backGround.setDisplaySize(game.config.width,game.config.height+32),this.bgmusic=this.sound.add("background-music",{loop:!1,volume:.5}),this.marker=0,this.bgmusic.play(),this.scoreText=this.add.text(game.config.width/2-100,55,"".concat(gameState.score),{fontFamily:"Nunito",fontStyle:"bold",fontSize:"40px",fill:"white",textAlign:"start"}).setOrigin(.5),this.scoreIcon=this.add.image(this.scoreText.x-90,this.scoreText.y,"scoreIcon").setOrigin(.5).setDisplaySize(60,66),this.gameInfo=this.add.image(265,60,"info").setScale(.43).setOrigin(.5),this.food=food=new Food(snacegame,30,20,"food"),this.snake=snake=new Snake(snacegame,20,20,"body_0"),this.snake.grow(),this.snake.grow(),document.addEventListener("keydown",function(e){(8==e.keyCode||10009==e.keyCode||461==e.keyCode||166==e.keyCode||196==e.keyCode)&&t.pause()}),this.loadScore(),console.log(this.snake),this.physics.add.collider(this.snake.bodySegments[1],this.food.body,function(){t.snake.grow(),t.repositionFood(),t.snake.biteSound.play(),gameState.score+=1},null,this),this.stopSound=setInterval(function(){t.soundOff(),t.marker>=5&&clearInterval(t.stopSound)&&t.bgmusic.stop()},1e3),this.versionText=this.add.text(game.config.width-60,game.config.height-40,"".concat(game_version),{fontFamily:"Nunito-black",fontStyle:"bold",fontSize:"30px",fill:"#fff"}).setOrigin(.5)}},{key:"soundOff",value:function e(){this.bgmusic.volume>0&&(this.bgmusic.volume-=.1,this.marker++)}},{key:"loadScore",value:function e(){localStorage.getItem("heighScore_snake")&&(console.log(localStorage.getItem("heighScore_snake")),this.hieghScoreText=this.add.text(this.scoreText.x+260,this.scoreText.y,"".concat(JSON.parse(localStorage.getItem("heighScore_snake"))),{fontFamily:"Nunito",fontStyle:"bold",fontSize:"40px",fill:"white",textAlign:"start"}).setOrigin(.5),this.hieghScoreIcon=this.add.image(this.hieghScoreText.x-90,this.hieghScoreText.y,"bestIcon").setDisplaySize(72,66).setOrigin(.5))}},{key:"pause",value:function e(){gameState.onGame=!1,this.scene.pause(snacegame),this.scene.launch(scenePause)}},{key:"addBonus",value:function e(t,i,n){var s=this;gameState.score>0&&gameState.score%10==0&&(this.bonus=new Bonus(this,t,i,"bonus_".concat(n),n),console.log(n),console.log(this.bonus),this.physics.add.collider(this.snake.bodySegments[1],this.bonus.body,function(){s.bonus.bonusSound.play(),0==s.bonus.index&&s.snake.speedUp(),1==s.bonus.index&&s.snake.godMode(),s.bonus.destroy()},null,this),setTimeout(function(){s.bonus.destroy()},12e3))}},{key:"update",value:function e(t,i){this.marker>=5&&clearInterval(this.stopSound)&&this.bgmusic.stop(),this.scoreText.setText("".concat(gameState.score)),game_session.score=gameState.score,snake.update(t)&&void 0!=this.bonus&&snake.collideWithBonus(this.bonus)&&this.bonus.destroy(),snake.alive||(this.snake.destroy(),this.scene.start("gameOver"))}},{key:"repositionFood",value:function e(){for(var t=[],i=6;i<game.config.height/CELL-2;i++)for(var n=3;n<game.config.width/CELL-3;n++){var s,o=_createForOfIteratorHelper(this.snake.bodySegments);try{for(o.s();!(s=o.n()).done;){var a=s.value;(a.x!==n||a.y!==i)&&t.push({x:n,y:i})}}catch(r){o.e(r)}finally{o.f()}}if(!(t.length>0))return!1;var h=Phaser.Math.RND.pick(t),c=Phaser.Math.RND.pick(t);return food.body.setPosition(h.x*CELL,h.y*CELL),this.addBonus(c.x,c.y,Math.floor(2*Math.random())),!0}}]),i}(Phaser.Scene),snacegame=new SnakeGame,GameOver=function(e){"use strict";_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.call(this,{key:"gameOver"})}return _createClass(i,[{key:"create",value:function e(){var t=this;game_session.action.gameOver=new Date().getTime(),console.log(game_session.action.gameOver),snacegame.bgmusic.stop(),gameState.onGame=!1,gameState.isOver=!0,this.menuBG=this.add.image(game.config.width/2,game.config.height/2,"mainBG_".concat(mainMenu.texturePack)).setOrigin(.5),this.menuBG.setDisplaySize(game.config.width,game.config.height),this.gameOverImg=this.add.image(game.config.width/2,game.config.height/2,"menuGameOver").setOrigin(.5),this.gameOverImg.setDisplaySize(game.config.width,game.config.height),this.scoreText=this.add.text(game.config.width/2,game.config.height-150,"СЧЁТ: ".concat(gameState.score),{fontFamily:"Nunito-black",fontStyle:"bold",fontSize:"32px",fill:"#2E3D66"}).setOrigin(.5),this.scoreText.setOrigin(.5),this.btnRestart=this.add.sprite(game.config.width/2,game.config.height/2+100,"button"),this.btnRestart.setOrigin(.5),this.btnRestart.setScale(.5),this.btnClose=this.add.sprite(this.btnRestart.x,this.btnRestart.y+120,"button").setScale(.5),this.btnClose.setOrigin(.5),this.selector=this.add.sprite(this.btnRestart.x,this.btnRestart.y,"selector"),this.selector.setOrigin(.5),this.selector.setScale(.44),this.btnRestart.setInteractive(),this.btnClose.setInteractive(),this.btnRestartText=this.add.text(game.config.width/2,game.config.height/2+100,"ЗАНОВО",{fontFamily:"Nunito",fontSize:"60px",fontStyle:"bold",align:"center",color:"black"}),this.btnRestartText.setOrigin(.5),this.btnCloseText=this.add.text(this.btnClose.x,this.btnClose.y,"ВЫЙТИ",{fontFamily:"Nunito",fontSize:"60px",fontStyle:"bold",align:"center",color:"black"}),this.btnCloseText.setOrigin(.5),this.btnRestart.on("pointerdown",this.startGame,this),this.btnClose.on("pointerdown",this.exit,this),this.input.keyboard.on("keydown-ENTER",this.gameToggle,this),document.addEventListener("keydown",function(e){(8==e.keyCode||10009==e.keyCode||461==e.keyCode||166==e.keyCode||196==e.keyCode)&&t.onPressExit()}),this.saveScore(),this.loadScore(),game_session.score=gameState.score,this.versionText=this.add.text(game.config.width-60,game.config.height-40,"".concat(game_version),{fontFamily:"Nunito-black",fontStyle:"bold",fontSize:"30px",fill:"#fff"}).setOrigin(.5)}},{key:"selectorDown",value:function e(){!0==gameState.isOver&&this.selector.y!=this.btnClose.y&&(this.selector.y=this.btnClose.y,this.btnCloseText.setColor("white"),this.clickSound.play())}},{key:"selectorUp",value:function e(){!0==gameState.isOver&&this.selector.y!=this.btnRestart.y&&(this.selector.y=this.btnRestart.y,mainMenu.clickSound.play())}},{key:"gameToggle",value:function e(){!0==gameState.isOver&&(this.selector.y==this.btnRestart.y?(mainMenu.clickSound.play(),this.startGame()):this.selector.y==this.btnClose.y&&(mainMenu.clickSound.play(),this.exit()))}},{key:"startGame",value:function e(){gameState.isOver=!1,gameState.score=0,mainMenu.texturePack=getTexturePack(),this.scene.start("snakegame")}},{key:"exit",value:function e(){var t;game_session.onClose=!0,null===(t=window)||void 0===t||t.parent.postMessage("GameExit","*"),game_session.action.closeGameSession=new Date().getTime()}},{key:"onPressExit",value:function e(){!1==gameState.onGame&&this.exit()}},{key:"saveScore",value:function e(){this.heighScore=gameState.score,game_session.highscore=JSON.parse(localStorage.getItem("heighScore_snake")),this.oldScore=JSON.parse(localStorage.getItem("heighScore_snake")),this.heighScore>this.oldScore?localStorage.setItem("heighScore_snake",JSON.stringify(this.heighScore)):this.heighScore=this.oldScore}},{key:"loadScore",value:function e(){localStorage.getItem("heighScore_snake")&&(console.log(localStorage.getItem("heighScore_snake")),this.hieghScoreText=this.add.text(game.config.width/2,game.config.height-100,"РЕКОРД: ".concat(JSON.parse(localStorage.getItem("heighScore_snake"))),{fontFamily:"Nunito-black",fontStyle:"bold",fontSize:"40px",fill:"#2E3D66"}).setOrigin(.5))}},{key:"update",value:function e(){this.selector.y===this.btnClose.y?this.btnCloseText.setColor("white"):this.btnCloseText.setColor("#F0516B"),this.selector.y===this.btnRestart.y?this.btnRestartText.setColor("white"):this.btnRestartText.setColor("#F0516B")}}]),i}(Phaser.Scene),gameOver=new GameOver,ScenePause=function(e){"use strict";_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.call(this,{key:"scenePause"})}return _createClass(i,[{key:"create",value:function e(){var t=this;gameState.onPause=!0,this.bgpauseImage=this.add.image(game.config.width/2,game.config.height/2,"mainBG_".concat(mainMenu.texturePack)).setOrigin(.5),this.bgpauseImage.setDisplaySize(game.config.width,game.config.height),this.pauseScreen=this.add.image(game.config.width/2,game.config.height/2,"pause").setOrigin(.5).setDisplaySize(game.config.width,game.config.height),this.btnStart=this.add.sprite(game.config.width/2,game.config.height/2+100,"button").setScale(.5),this.btnStart.setOrigin(.5),this.btnClose=this.add.sprite(this.btnStart.x,this.btnStart.y+120,"button").setScale(.5),this.btnClose.setOrigin(.5),this.selector=this.add.image(game.config.width/2,game.config.height/2+100,"selector"),this.selector.setScale(.44),this.selector.setOrigin(.5),this.btnStartText=this.add.text(game.config.width/2,game.config.height/2+100,"ПРОДОЛЖИТЬ",{fontFamily:"Nunito",fontSize:"60px",color:"black",fontStyle:"bold",align:"center"}),this.btnStartText.setOrigin(.5),this.btnCloseText=this.add.text(this.btnClose.x,this.btnClose.y,"ВЫЙТИ",{fontFamily:"Nunito",fontSize:"60px",color:"black",fontStyle:"bold",align:"center"}),this.btnCloseText.setOrigin(.5),this.btnStart.setInteractive(),this.btnClose.setInteractive(),this.btnClose.on("pointerdown",this.exit,this),this.btnStart.on("pointerdown",this.resumeGame,this),document.addEventListener("keydown",function(e){(8==e.keyCode||10009==e.keyCode||461==e.keyCode||166==e.keyCode||196==e.keyCode)&&t.onPressExit()}),this.input.keyboard.on("keydown-ENTER",this.gameToggle,this),this.scoreText=this.add.text(game.config.width/2,game.config.height-150,"СЧЁТ: ".concat(gameState.score),{fontFamily:"Nunito-black",fontStyle:"bold",fontSize:"32px",fill:"#2E3D66"}).setOrigin(.5),this.loadScore()}},{key:"loadScore",value:function e(){localStorage.getItem("heighScore_snake")&&(console.log(localStorage.getItem("heighScore_snake")),this.hieghScoreText=this.add.text(game.config.width/2,game.config.height-100,"РЕКОРД: ".concat(JSON.parse(localStorage.getItem("heighScore_snake"))),{fontFamily:"Nunito-black",fontStyle:"bold",fontSize:"40px",fill:"#2E3D66"}).setOrigin(.5))}},{key:"selectorDown",value:function e(){!0==gameState.onPause&&this.selector.y!=this.btnClose.y&&(this.selector.y=this.btnClose.y,mainMenu.clickSound.play())}},{key:"selectorUp",value:function e(){!0==gameState.onPause&&this.selector.y!=this.btnStart.y&&(this.selector.y=this.btnStart.y,mainMenu.clickSound.play())}},{key:"gameToggle",value:function e(){if(!0==gameState.onPause){if(this.selector.y==this.btnStart.y)this.resumeGame(),mainMenu.clickSound.play();else if(this.selector.y==this.btnClose.y){var t;mainMenu.clickSound.play(),null===(t=window)||void 0===t||t.parent.postMessage("GameExit","*"),gameOver.exit()}}}},{key:"resumeGame",value:function e(){gameState.onPause=!1,gameState.onGame=!0,this.scene.resume(snacegame),this.scene.stop(scenePause)}},{key:"exit",value:function e(){game_session.action.closeGameSession=new Date().getTime()}},{key:"onPressExit",value:function e(){!0==gameState.onPause&&gameOver.exit()}},{key:"update",value:function e(){this.selector.y===this.btnClose.y?this.btnCloseText.setColor("white"):this.btnCloseText.setColor("#F0516B"),this.selector.y===this.btnStart.y?this.btnStartText.setColor("white"):this.btnStartText.setColor("#F0516B")}}]),i}(Phaser.Scene),scenePause=new ScenePause,Preloader=function(e){"use strict";_inherits(i,e);var t=_createSuper(i);function i(){var e;return _classCallCheck(this,i),(e=t.call(this,{key:"preloader"})).loadText,e}return _createClass(i,[{key:"preload",value:function e(){this.loadText=this.add.text(game.config.width/2,game.config.height/2,"ЗАГРУЗКА...",{fontFamily:"Nunito-black",fontStyle:"bold",fontSize:"40px",fill:"white"}),this.loadText2=this.add.text(game.config.width/2,game.config.height/2,"ЗАГРУЗКА...",{fontFamily:"Nunito",fontStyle:"bold",fontSize:"40px",fill:"white"}),this.loadText2.visible=!1,this.loadText.setOrigin(.5),this.load.setPath("assets/"),this.load.image("info","gameInfo.png"),this.load.image("controlsInfo","controlsInfo.png"),this.load.image("background_0","skins/bg_0.png"),this.load.image("background_1","skins/bg_1.png"),this.load.image("background_2","skins/bg_2.png"),this.load.image("head_0","skins/head_0.png"),this.load.image("head_1","skins/head_1.png"),this.load.image("head_2","skins/head_2.png"),this.load.image("head_lick_0","/skins/head_lick_0.png"),this.load.image("head_lick_1","/skins/head_lick_1.png"),this.load.image("head_lick_2","/skins/head_lick_2.png"),this.load.image("body_0","skins/body_0.png"),this.load.image("body_1","skins/body_1.png"),this.load.image("body_2","skins/body_2.png"),this.load.image("tail_0","skins/tail_0.png"),this.load.image("tail_1","skins/tail_1.png"),this.load.image("tail_2","skins/tail_2.png"),this.load.image("scoreIcon","ui/scoreIcon.png"),this.load.image("bestIcon","ui/bestIcon.png"),this.load.image("menuStart","ui/menuStart.png"),this.load.image("menuGameOver","ui/menuGameOver.png"),this.load.image("mainBG_0","ui/uibg_0.png"),this.load.image("mainBG_1","ui/uibg_1.png"),this.load.image("mainBG_2","ui/uibg_2.png"),this.load.image("pause","ui/pause.png"),this.load.image("button","button.png"),this.load.image("selector","selector.png"),this.load.image("food","food.png"),this.load.image("food_small","food_small.png"),this.load.image("food_big","food_big.png"),this.load.image("bonus_1","bonus_1.png"),this.load.image("bonus_0","bonus_0.png"),this.load.image("bonus_small_0","bonus_small_0.png"),this.load.image("bonus_small_1","bonus_small_1.png"),this.load.image("bonus_big_0","bonus_big_0.png"),this.load.image("bonus_big_1","bonus_big_1.png"),this.load.image("head_helmet_0","/skins/head_helmet_0.png"),this.load.image("head_helmet_1","/skins/head_helmet_1.png"),this.load.image("head_helmet_2","/skins/head_helmet_2.png"),this.load.image("head_helmet_nolick_0","/skins/head_helmet_nolick_0.png"),this.load.image("head_helmet_nolick_1","/skins/head_helmet_nolick_1.png"),this.load.image("head_helmet_nolick_2","/skins/head_helmet_nolick_2.png"),this.load.audio("background-music","sounds/background_music.mp3"),this.load.audio("bite","sounds/bite.mp3"),this.load.audio("bonus","sounds/bonus.mp3"),this.load.audio("click","sounds/click.mp3"),this.load.audio("down","sounds/down.mp3"),this.load.audio("left","sounds/left.mp3"),this.load.audio("lose","sounds/lose.mp3"),this.load.audio("right","sounds/right.mp3"),this.load.audio("up","sounds/up.mp3")}},{key:"create",value:function e(){this.scene.start(mainMenu)}}]),i}(Phaser.Scene),preloader=new Preloader,MainMenu=function(e){"use strict";_inherits(i,e);var t=_createSuper(i);function i(){return _classCallCheck(this,i),t.call(this,{key:"mainMenu"})}return _createClass(i,[{key:"create",value:function e(){var t=this;game_session.action.startGameSession=new Date().getTime(),console.log(game_session.action.startGameSession),this.texturePack=getTexturePack(),gameState.onMenu=!0,this.menuBG=this.add.image(game.config.width/2,game.config.height/2,"mainBG_".concat(this.texturePack)).setOrigin(.5),this.menuBG.setDisplaySize(game.config.width,game.config.height),this.mainbg=this.add.image(game.config.width/2,game.config.height/2,"menuStart").setOrigin(.5),this.mainbg.setDisplaySize(game.config.width,game.config.height),this.controlsInfo=this.add.image(game.config.width-310,70,"controlsInfo").setOrigin(.5),this.btnStart=this.add.sprite(game.config.width/2,game.config.height/2+100,"button").setScale(.5),this.btnStart.setOrigin(.5),this.btnClose=this.add.sprite(this.btnStart.x,this.btnStart.y+120,"button").setScale(.5),this.btnClose.setOrigin(.5),this.selector=this.add.image(this.btnStart.x,this.btnStart.y,"selector").setScale(.44),this.selector.setOrigin(.5),this.btnStartText=this.add.text(this.btnStart.x,this.btnStart.y,"НАЧАТЬ ИГРУ",{fontFamily:"Nunito",fontSize:"60px",color:"black",fontStyle:"bold",align:"center"}),this.btnStartText.setOrigin(.5),this.btnCloseText=this.add.text(this.btnClose.x,this.btnClose.y,"ВЫЙТИ",{fontFamily:"Nunito",fontSize:"60px",color:"black",fontStyle:"bold",align:"center"}),this.btnCloseText.setOrigin(.5),this.input.keyboard.on("keydown-ENTER",this.gameToggle,this),document.addEventListener("keydown",function(e){(8==e.keyCode||10009==e.keyCode||461==e.keyCode||166==e.keyCode||196==e.keyCode)&&t.onPressExit()}),this.clickSound=this.sound.add("click",{loop:!1}),this.loadScore(),this.anims.create({key:"food-animation",frames:[{key:"food_small",duration:500},{key:"food",duration:500},{key:"food_big",duration:500}],frameRate:6,repeat:-1}),this.bonus=new Bonus(this,-1,-1,"bonus_".concat(1),1),this.bonus.alpha=0,this.anims.create({key:"liking_0",frames:[{key:"head_0"},{key:"head_lick_0",duration:1e3}],frameRate:6,repeat:-1}),this.anims.create({key:"liking_1",frames:[{key:"head_1"},{key:"head_lick_1",duration:1e3}],frameRate:6,repeat:-1}),this.anims.create({key:"liking_2",frames:[{key:"head_2"},{key:"head_lick_2",duration:1e3}],frameRate:6,repeat:-1}),this.anims.create({key:"onGodeAnimation_0",frames:[{key:"head_helmet_0"},{key:"head_helmet_nolick_0",duration:1e3}],frameRate:4,repeat:-1}),this.anims.create({key:"onGodeAnimation_1",frames:[{key:"head_helmet_1"},{key:"head_helmet_nolick_1",duration:1e3}],frameRate:4,repeat:-1}),this.anims.create({key:"onGodeAnimation_2",frames:[{key:"head_helmet_2"},{key:"head_helmet_nolick_2",duration:1e3}],frameRate:4,repeat:-1}),this.versionText=this.add.text(game.config.width-60,game.config.height-40,"".concat(game_version),{fontFamily:"Nunito-black",fontStyle:"bold",fontSize:"30px",fill:"#fff"}).setOrigin(.5),document.getElementsByTagName("canvas")[0];for(var i=[],n=[],s=this.btnStart.x-this.btnStart.width/2;s<this.btnStart.x+this.btnStart.width/2;s++)i.push(s);for(var o=this.btnStart.y-this.btnStart.height/2;o<this.btnStart.y+this.btnStart.height/2;o++)n.push(o);this.createButton()}},{key:"createButton",value:function e(){var t=this;document.getElementsByTagName("canvas")[0];var i=document.createElement("button");i.innerHTML="Start",i.addEventListener("click",function(){t.startGame(),i.remove()}),document.getElementById("phaser-example").appendChild(i),i.setAttribute("id","startBtn"),i.style.position="absolute",i.style.left=window.innerWidth/3+"px",i.style.top=window.innerHeight/1.8+"px",i.style.height=this.btnStart.height/2+"px",i.style.width=this.btnStart.width/2+"px",i.style.opacity=0}},{key:"checkPosX",value:function e(t,i){console.log("Координаты клика:".concat(t.offsetX,", ").concat(t.offsetY));var n=!1;return i.forEach(function(e){e===t.offsetX&&(n=!0)}),n}},{key:"checkPosY",value:function e(t,i){var n=!1;return i.forEach(function(e){Math.floor(e)===t.offsetY&&(n=!0)}),n}},{key:"loadScore",value:function e(){localStorage.getItem("heighScore_snake")?(game_session.highscore=JSON.parse(localStorage.getItem("heighScore_snake")),this.hieghScoreText=this.add.text(game.config.width/2,game.config.height-100,"РЕКОРД  ".concat(JSON.parse(localStorage.getItem("heighScore_snake"))),{fontFamily:"Nunito-black",fontStyle:"bold",fontSize:"65px",fill:"#2E3D66"}).setOrigin(.5)):this.hieghScoreText=this.add.text(game.config.width/2,game.config.height-100,"РЕКОРД 0",{fontFamily:"Nunito",fontStyle:"bold",fontSize:"65px",fill:"#2E3D66"}).setOrigin(.5)}},{key:"selectorDown",value:function e(){!0==gameState.onMenu&&this.selector.y!=this.btnClose.y&&(this.selector.y=this.btnClose.y,this.btnCloseText.setColor("white"),this.clickSound.play())}},{key:"selectorUp",value:function e(){!0==gameState.onMenu&&this.selector.y!=this.btnStart.y&&(this.selector.y=this.btnStart.y,this.clickSound.play())}},{key:"gameToggle",value:function e(){if(!0==gameState.onMenu){if(this.selector.y==this.btnStart.y)this.startGame(),this.clickSound.play();else if(this.selector.y==this.btnClose.y){var t;this.clickSound.play(),null===(t=window)||void 0===t||t.parent.postMessage("GameExit","*"),this.exit()}}}},{key:"startGame",value:function e(){gameState.onMenu=!1,this.scene.start("snakegame")}},{key:"exit",value:function e(){game_session.action.closeGameSession=new Date().getTime()}},{key:"onPressExit",value:function e(){!1==gameState.onGame&&gameOver.exit()}},{key:"update",value:function e(){this.selector.y===this.btnClose.y?this.btnCloseText.setColor("white"):this.btnCloseText.setColor("#F0516B"),this.selector.y===this.btnStart.y?this.btnStartText.setColor("white"):this.btnStartText.setColor("#F0516B")}}]),i}(Phaser.Scene),mainMenu=new MainMenu;